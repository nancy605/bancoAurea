<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">

    <link href="assets/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/style.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-nw04uA6Gb8KuIr7/zpJZ6V3VvXyLqiw5g2Qp0iAJmzN+B6V1Z2VCe0JNwF9tTJpP" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-IXjXzdm6E1UyAUR7uy7WJHkFdq+9pFNGsCsf2V/e5O4J20Nz7xEsEmheq7Hq5cg4" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.9/dist/sweetalert2.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.1.9/dist/sweetalert2.min.js"></script>
    

    <script type="text/javascript">
        var cajas_radios;
        var conexion;
        addEvent(window,'load',cargar, false);
        
        function addEvent(ele,eve,fun,cap){
            if(window.attachEvent)
                addAttachEvent('on'+eve,fun);
            else
                ele.addEventListener(eve,fun,cap);
        }
  
        function cargar(){
            cajas_radios = document.getElementsByTagName("input");
            var botonRegistro = document.getElementsByClassName("btn_sesionE")[0];
            addEvent(botonRegistro, 'click', validaDatos, false);
            addEvent(cajas_radios[0],'keypress',filtraNumeros,false);
        }
  
        function validaDatos(event){
            event.preventDefault();  // Evitar la recarga de la página
  
            if (cajas_radios[0].value !== "" && 
                cajas_radios[1].value !== "" ) {
                conexionServidor();
            } else {
                Swal.fire({
                    title: "Falta algún dato",
                    confirmButtonText:"Confirmar"
                });
            }
        }
  
        function conexionServidor(){
            conexion = xmlhttprequest();
            conexion.onreadystatechange = esperaRespuesta;
            conexion.open("POST","sesionEmp.php",true);   
            conexion.setRequestHeader("Content-type","application/x-www-form-urlencoded");  
            conexion.send("ID="+cajas_radios[0].value+"&password="+cajas_radios[1].value);
        }

        function esperaRespuesta(){
    if(conexion.readyState == 4){
        if (conexion.status == 200) {
            var responseText = conexion.responseText;
            if (responseText.startsWith("Inicio de sesión exitoso")) {
                Swal.fire({
                    title: "Éxito",
                    text: responseText,
                    confirmButtonText: "Confirmar"
                }).then(() => {
                    window.location.href = "regisObusc.php"; // Cambia a la página deseada
                });
            } else {
                Swal.fire({
                    title: "Error",
                    text: responseText,
                    confirmButtonText: "Confirmar"
                });
            }
        } else {
            Swal.fire({
                title: "Error",
                text: "Hubo un problema con la conexión.",
                confirmButtonText: "Confirmar"
            });
        }
    } 
}

        
        function xmlhttprequest(){
            return new XMLHttpRequest();
        }
        
        function filtraNumeros(){
            if(event.keyCode >= 48 && event.keyCode <= 57){
                if(cajas_radios[2].value <= 999999999)
                    event.returnValue = true;
                else
                    event.returnValue = false;
            } else
                event.returnValue = false;
        }
    </script>

    <title>INICIAR SESIÓN</title>
</head>

<body>
<section class="form-02-main">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="_lk_de">
                    <div class="form-03-main">
                        <div class="logo">
                            <img src="assets/images/user.png" alt="User Icon"> 
                            <span class="logo-text">Banco Áurea</span>
                        </div>
                        <form id="loginForm">
                            <div class="form-group">
                                <input type="text" name="ID" id="ID" class="form-control _ge_de_ol" placeholder="ID" required>
                            </div>
                            <div class="form-group">
                                <input type="password" name="password" id="password" class="form-control _ge_de_ol" placeholder="Password" required>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn_sesionE">INICIAR SESIÓN</button>
                            </div>
                            <div class="form-group">
                                <a href="Bienvenida.html" class="btn-regresar"><i class="fa fa-arrow-left"></i> Regresar</a>
                            </div>
                            <div id="message" class="alert" style="display:none;"></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
</html>